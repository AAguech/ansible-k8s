---

- name: Create a directory if it does not exist
  ansible.builtin.file:
    path: /home/kub/amira
    state: directory
    mode: '0755'

#- name: Change file ownership, group and permissions
#  ansible.builtin.file:
#    path: /var/run/docker.sock
#    owner: root
 #   group: docker
 #   mode: '666'
 # become_method: sudo
  

- name: Log into DockerHub
  docker_login:
    username: aguech
    password: Lasmar.eline2021
    email: amira.aguech.lasmar@gmail.com
  run_once: true


- name: pull an image
  docker_image:
    name: hello-world
    pull: yes

- name: Tag and push to local registry
  docker_image:
     name: hello-word
     archive_path: /home/kub/amira
     pull: yes
     push: yes

  
#  become: yes
    #username: aguech
   # password: Lasmar.eline2021
- name: log to jfrog 
  docker_login:
    registry: sncf.jfrog.io/docker-amira-local
    username: amira.aguech.lasmar@gmail.com
    password: Lasmar&eline2021

- name : tag image with command before to push it
  command: docker tag hello-world:latest hello-word:v1

- name: Build an image and push it to a private repo
  docker_image:
    name: hello-world:v1
    repository: sncf.jfrog.io/docker-amira-local/hello-world
    push: yes
    pull: no